{"version":3,"file":"FormController-a24Yjre7.js","sources":["../../src/form/useFormActions.tsx","../../src/form/useFormListener.tsx","../../src/form/FormListener.tsx","../../src/form/FormController.tsx"],"sourcesContent":["import { useContext } from \"react\";\n\nimport { FormActions } from \"../field/types\";\nimport { FormActionContext } from \"./context/FormActionContext\";\n\nexport function useFormActions<\n  FormValues extends {}\n>(): FormActions<FormValues> {\n  return useContext(FormActionContext);\n}\n","import { useEffect } from \"react\";\nimport { useFormContext } from \"react-hook-form\";\n\nimport {\n  ChangedField,\n  FormChangeHandler,\n  PartialFormValues,\n} from \"../field/types\";\nimport { useLatestRef } from \"../hook/useLatestRef\";\nimport { useFormActions } from \"./useFormActions\";\n\n/**\n * Form listener hook that will trigger the callback on every value change\n *\n * @param onChange\n */\nexport function useFormListener<FormValues extends {}>(\n  onChange: FormChangeHandler<FormValues>\n): void {\n  const { watch } = useFormContext<FormValues>();\n\n  // Remember the latest callback.\n  const changeCallbackRef =\n    useLatestRef<FormChangeHandler<FormValues>>(onChange);\n\n  // Get actions\n  const actions = useFormActions<FormValues>();\n  const actionsRef = useLatestRef(actions);\n\n  // Set up the watcher\n  useEffect(() => {\n    const subscription = watch((values, { name }) => {\n      changeCallbackRef.current(\n        values as PartialFormValues<FormValues>,\n        actionsRef.current,\n        { name } as ChangedField<FormValues>\n      );\n    });\n\n    return () => {\n      subscription.unsubscribe();\n    };\n  }, [watch]);\n}\n","import { FormChangeHandler } from \"../field/types\";\nimport { useFormListener } from \"./useFormListener\";\n\nexport type FormListenerProps<FormValues extends {}> = {\n  onChange: FormChangeHandler<FormValues>;\n};\n\nexport function FormListener<FormValues extends {}>(\n  props: FormListenerProps<FormValues>\n) {\n  const { onChange } = props;\n\n  useFormListener(onChange);\n\n  return null;\n}\n","import * as React from \"react\";\nimport { CSSProperties, ReactNode } from \"react\";\n\nimport { FormChangeHandler } from \"../field/types\";\nimport { FormListener } from \"./FormListener\";\nimport { FormProvider } from \"./FormProvider\";\nimport { UseFormControllerProps, useFormController } from \"./useFormController\";\n\nexport interface FormControllerProps<FormValues extends {}>\n  extends UseFormControllerProps<FormValues> {\n  id?: string;\n  children?: ReactNode;\n  className?: string;\n  style?: CSSProperties;\n  onChange?: FormChangeHandler<FormValues>;\n}\n\nexport function FormController<FormValues extends {}>(\n  props: FormControllerProps<FormValues>\n) {\n  const { id, children, initialValues, onSubmit, onChange, className, style } =\n    props;\n\n  const form = useFormController<FormValues>({\n    initialValues,\n    onSubmit,\n  });\n\n  const { handleSubmit, handleReset } = form;\n\n  return (\n    <form\n      id={id}\n      onSubmit={handleSubmit}\n      onReset={handleReset}\n      className={className}\n      style={style}\n    >\n      <FormProvider {...form}>\n        {onChange != null && <FormListener onChange={onChange} />}\n        {children}\n      </FormProvider>\n    </form>\n  );\n}\n"],"names":["useFormActions","useContext","FormActionContext","useFormListener","onChange","watch","useFormContext","changeCallbackRef","useLatestRef","actions","actionsRef","useEffect","subscription","values","name","FormListener","props","FormController","id","children","initialValues","onSubmit","className","style","form","useFormController","handleSubmit","handleReset","jsx","jsxs","FormProvider"],"mappings":"mOAKO,SAASA,GAEa,CAC3B,OAAOC,EAAAA,WAAWC,CAAiB,CACrC,CCOO,SAAAC,EAAAC,EAAA,CAGL,KAAA,CAAA,MAAAC,GAAAC,IAGAC,EAAAC,EAAAJ,CAAA,EAIAK,EAAAT,IACAU,EAAAF,EAAAC,CAAA,EAGAE,EAAAA,UAAA,IAAA,CACE,MAAAC,EAAAP,EAAA,CAAAQ,EAAA,CAAA,KAAAC,CAAA,IAAA,CACEP,EAAA,QAAkBM,EAChBH,EAAA,QACW,CAAA,KAAAI,CAAA,CACJ,CACT,CAAA,EAGF,MAAA,IAAA,CACEF,EAAA,YAAA,CAAyB,CAC3B,EAAA,CAAAP,CAAA,CAAA,CAEJ,0LCpCO,SAAAU,EAAAC,EAAA,CAGL,KAAA,CAAA,SAAAZ,CAAA,EAAAY,EAEA,OAAAb,EAAAC,CAAA,EAEA,IACF,gOCEO,SAAAa,EAAAD,EAAA,CAGL,KAAA,CAAA,GAAAE,EAAA,SAAAC,EAAA,cAAAC,EAAA,SAAAC,EAAA,SAAAjB,EAAA,UAAAkB,EAAA,MAAAC,CAAA,EAAAP,EAGAQ,EAAAC,EAAA,CAA2C,cAAAL,EACzC,SAAAC,CACA,CAAA,EAGF,CAAA,aAAAK,EAAA,YAAAC,CAAA,EAAAH,EAEA,OAAAI,EACE,OAAC,CAAA,GAAAV,EACC,SAAAQ,EACU,QAAAC,EACD,UAAAL,EACT,MAAAC,EACA,SAAAM,EAAAC,EAAA,CAAA,GAAAN,EAAA,SAAA,CAGGpB,GAAA,MAAAwB,EAAAb,EAAA,CAAA,SAAAX,CAAA,CAAA,EAAsDe,CACtD,EAAA,CACH,CAAA,CAGN"}