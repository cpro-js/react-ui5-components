import{E as v,s as l}from"./useIsomorphicLayoutEffect-xRq3KBKR.js";const a=new WeakMap;class n{static get tasks(){return a}static enqueue(t,s){a.has(t)||a.set(t,[]),a.get(t).push(s)}static run(t,s){return a.has(t)||a.set(t,[]),s().then(()=>{const e=a.get(t);if(e.length>0)return n.run(t,e.shift());a.delete(t)})}static push(t,s){a.get(t)?n.enqueue(t,s):n.run(t,s)}}const T=i=>{let t=null,s=!1,e,r,o;const c=new Promise((h,u)=>{o=p=>{t=t||p;const d=p-t,g=i.duration-d;if(d<=i.duration){const f=1-g/i.duration;i.advance(f),s||(e=requestAnimationFrame(o))}else i.advance(1),h()},r=()=>{s=!0,cancelAnimationFrame(e),u(new Error("animation stopped"))}}).catch(h=>h);return n.push(i.element,()=>(typeof i.beforeStart=="function"&&i.beforeStart(),requestAnimationFrame(o),new Promise(h=>{c.then(()=>h())}))),{promise:()=>c,stop:()=>r}},m=400,_=(i,t,s)=>{let e,r;return T({beforeStart:()=>{e=i.scrollLeft,r=i.scrollTop},duration:m,element:i,advance:o=>{i.scrollLeft=e+o*t,i.scrollTop=r+o*s}})},X="scroll",E=l()?"touchend":"mouseup";class D extends v{constructor(t){super(),this.supportsTouch=l(),this.containerComponent=t,this.mouseMove=this.ontouchmove.bind(this),this.mouseUp=this.ontouchend.bind(this),this.touchStart=this.ontouchstart.bind(this),this.supportsTouch=l(),this.cachedValue={dragX:0,dragY:0},this.startX=0,this.startY=0,this.supportsTouch?(t.addEventListener("touchstart",this.touchStart,{passive:!0}),t.addEventListener("touchmove",this.mouseMove,{passive:!0}),t.addEventListener("touchend",this.mouseUp,{passive:!0})):t.addEventListener("mousedown",this.touchStart,{passive:!0})}set scrollContainer(t){this._container=t}get scrollContainer(){return this._container}async scrollTo(t,s,e=0,r=0){let o=this.scrollContainer.clientHeight>0&&this.scrollContainer.clientWidth>0;for(;!o&&e>0;)await new Promise(c=>{setTimeout(()=>{o=this.scrollContainer.clientHeight>0&&this.scrollContainer.clientWidth>0,e--,c()},r)});this._container.scrollLeft=t,this._container.scrollTop=s}move(t,s,e){if(e){this._container.scrollLeft+=t,this._container.scrollTop+=s;return}if(this._container)return _(this._container,t,s)}getScrollLeft(){return this._container.scrollLeft}getScrollTop(){return this._container.scrollTop}_isTouchInside(t){let s=null;this.supportsTouch&&t instanceof TouchEvent&&(s=t.touches[0]);const e=this._container.getBoundingClientRect(),r=this.supportsTouch?s.clientX:t.x,o=this.supportsTouch?s.clientY:t.y;return r>=e.left&&r<=e.right&&o>=e.top&&o<=e.bottom}ontouchstart(t){let s=null;this.supportsTouch&&t instanceof TouchEvent&&(s=t.touches[0]),this.supportsTouch?(this.startX=s.pageX,this.startY=s.pageY):(document.addEventListener("mouseup",this.mouseUp,{passive:!0}),document.addEventListener("mousemove",this.mouseMove,{passive:!0})),this.supportsTouch&&t instanceof TouchEvent&&(this._prevDragX=s.pageX,this._prevDragY=s.pageY),t instanceof MouseEvent&&(this._prevDragX=t.x,this._prevDragY=t.y),this._canScroll=this._isTouchInside(t)}ontouchmove(t){if(!this._canScroll)return;const s=this._container,e=this.supportsTouch?t.touches[0]:null,r=this.supportsTouch?e.pageX:t.x,o=this.supportsTouch?e.pageY:t.y;s.scrollLeft+=this._prevDragX-r,s.scrollTop+=this._prevDragY-o,this.fireEvent(X,{isLeft:r>this._prevDragX,isRight:r<this._prevDragX}),this.cachedValue.dragX=this._prevDragX,this.cachedValue.dragY=this._prevDragY,this._prevDragX=r,this._prevDragY=o}ontouchend(t){if(this.supportsTouch){const h=Math.abs(t.changedTouches[0].pageX-this.startX),u=Math.abs(t.changedTouches[0].pageY-this.startY);if(h<10&&u<10)return}if(!this._canScroll)return;const s=this._container,e=this.supportsTouch?t.changedTouches[0].pageX:t.x,r=this.supportsTouch?t.changedTouches[0].pageY:t.y;s.scrollLeft+=this._prevDragX-e,s.scrollTop+=this._prevDragY-r;const c=e===this._prevDragX?this.cachedValue.dragX:e;this.fireEvent(E,{isLeft:c<this._prevDragX,isRight:c>this._prevDragX}),this._prevDragX=e,this._prevDragY=r,this.supportsTouch||(document.removeEventListener("mousemove",this.mouseMove),document.removeEventListener("mouseup",this.mouseUp))}}export{D as S,T as a,m as d};
//# sourceMappingURL=ScrollEnablement-Ha971trf.js.map
